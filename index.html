<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–æ—Ç–æ–∫–æ–ª —Ä–∞–±–æ—Ç—ã –º—É–ª—å—Ç–∏–¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞—Ä–Ω–æ–π –±—Ä–∏–≥–∞–¥—ã</title>
    
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.5.3/vue.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.27.0/moment.min.js"></script>
    <script src="https://docs.getgrist.com/grist-plugin-api.js"></script>
    
    <style>
        /* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            padding: 0;
            background-color: #f9f9f9;
            color: #333;
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 24px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–æ–ª–µ–π —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø–∞—Ü–∏–µ–Ω—Ç–µ */
        .patient-info {
            background-color: #ffffff;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .patient-info p {
            margin: 5px 0;
            font-size: 14px;
        }

        .patient-info strong {
            color: #2c3e50;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            background-color: #ffffff;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            overflow: hidden;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background-color: #2c3e50;
            color: #ffffff;
            font-weight: bold;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –∏–µ—Ä–∞—Ä—Ö–∏–∏ */
        .participant-row {
            background-color: #f1f1f1; /* –°–≤–µ—Ç–ª—ã–π —Ñ–æ–Ω –¥–ª—è —Å—Ç—Ä–æ–∫–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞ */
        }

        .goal-row {
            background-color: #f9f9f9; /* –ï—â–µ –±–æ–ª–µ–µ —Å–≤–µ—Ç–ª—ã–π —Ñ–æ–Ω –¥–ª—è —Å—Ç—Ä–æ–∫–∏ —Ü–µ–ª–∏ */
        }

        .task-row {
            padding-left: 30px; /* –û—Ç—Å—Ç—É–ø –¥–ª—è –∑–∞–¥–∞—á */
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ –≤—Ä–∞—á–∞ */
        .doctor-signature {
            background-color: #ffffff;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
        }

        .doctor-signature p {
            margin: 5px 0;
            font-size: 14px;
        }

        .doctor-signature strong {
            color: #2c3e50;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –ø–µ—á–∞—Ç–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) */
        .print-button {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 200px;
            margin: 20px auto;
            padding: 10px;
            background-color: #2c3e50;
            color: #ffffff;
            text-align: center;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }

        .print-button:hover {
            background-color: #34495e;
        }

        .print-icon {
            font-size: 20px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–µ—á–∞—Ç–∏ */
        @media print {
            .print-button {
                display: none; /* –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –ø—Ä–∏ –ø–µ—á–∞—Ç–∏ */
            }

            body {
                font-family: Georgia, serif;
                font-size: 16px;
                background-color: #ffffff; /* –£–±–∏—Ä–∞–µ–º —Ñ–æ–Ω –¥–ª—è –ø–µ—á–∞—Ç–∏ */
                color: #000000; /* –ß–µ—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è –ø–µ—á–∞—Ç–∏ */
            }

            .patient-info, .doctor-signature {
                box-shadow: none; /* –£–±–∏—Ä–∞–µ–º —Ç–µ–Ω–∏ –¥–ª—è –ø–µ—á–∞—Ç–∏ */
                border: 1px solid #ddd; /* –î–æ–±–∞–≤–ª—è–µ–º —Ä–∞–º–∫—É –¥–ª—è –ø–µ—á–∞—Ç–∏ */
            }

            table {
                box-shadow: none; /* –£–±–∏—Ä–∞–µ–º —Ç–µ–Ω–∏ –¥–ª—è –ø–µ—á–∞—Ç–∏ */
                border: 1px solid #ddd; /* –î–æ–±–∞–≤–ª—è–µ–º —Ä–∞–º–∫—É –¥–ª—è –ø–µ—á–∞—Ç–∏ */
            }

            th, td {
                border-bottom: 1px solid #000; /* –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏ –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è —Å—Ç—Ä–æ–∫ */
                padding: 10px;
            }

            th {
                background-color: #f1f1f1; /* –£–±–∏—Ä–∞–µ–º —Ç–µ–º–Ω—ã–π —Ñ–æ–Ω –¥–ª—è –ø–µ—á–∞—Ç–∏ */
                color: #000000; /* –ß–µ—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è –ø–µ—á–∞—Ç–∏ */
            }

            .participant-row {
                background-color: #f9f9f9; /* –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–æ–Ω –¥–ª—è –ø–µ—á–∞—Ç–∏ */
            }

            .goal-row {
                background-color: #e9e9e9; /* –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–æ–Ω –¥–ª—è –ø–µ—á–∞—Ç–∏ */
            }

            .task-row {
                background-color: #fff; /* –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–æ–Ω –¥–ª—è –ø–µ—á–∞—Ç–∏ */
            }

            td:nth-child(7), td:nth-child(8) {
                text-align: right;
            }
        }
    </style>
</head>
<body>
    <h1>–ü—Ä–æ—Ç–æ–∫–æ–ª —Ä–∞–±–æ—Ç—ã –º—É–ª—å—Ç–∏–¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞—Ä–Ω–æ–π –±—Ä–∏–≥–∞–¥—ã –æ—Ç–¥–µ–ª–µ–Ω–∏—è —Ä–µ–∞–±–∏–ª–∏—Ç–∞—Ü–∏–∏ –¥–ª—è –¥–µ—Ç–µ–π –†–î–ö–ë</h1>
    
    <!-- –ë–ª–æ–∫ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø–∞—Ü–∏–µ–Ω—Ç–µ -->
    <div class="patient-info">
        <p><strong>–ü–∞—Ü–∏–µ–Ω—Ç –§–ò–û:</strong> <span id="patient_FIO"></span></p>
        <p><strong>–í–æ–∑—Ä–∞—Å—Ç:</strong> <span id="patient_age"></span></p>
        <p><strong>–î–∏–∞–≥–Ω–æ–∑:</strong> <span id="diagnoz"></span></p>
        <p><strong>–î–∞—Ç–∞ –∑–∞—Å–µ–¥–∞–Ω–∏—è:</strong> <span id="date_mdb"></span></p>
        <p><strong>–†–µ–∞–±–∏–ª–∏—Ç–∞—Ü–∏–æ–Ω–Ω—ã–π –¥–∏–∞–≥–Ω–æ–∑:</strong> <span id="mkf_values"></span></p> <!-- –ù–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –ú–ö–§ -->
    </div>

    <!-- –¢–∞–±–ª–∏—Ü–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ -->
    <table id="doctorsTable">
        <thead>
            <tr>
                <th>‚Ññ</th>
                <th>–£—á–∞—Å—Ç–Ω–∏–∫ –ú–î–†–ö</th>
                <th>–£—á–∞—Å—Ç–∏–µ</th>
                <th>–¶–µ–ª—å</th>
                <th>–ú–ö–§</th>
                <th>–ó–∞–¥–∞—á–∏</th>
                <th>–ú–µ—Ç–æ–¥–∏–∫–∞</th>
                <th>–û—Ü–µ–Ω–∫–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ –∫—É—Ä—Å–∞</th>
                <th>–û—Ü–µ–Ω–∫–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Å–ª–µ –∫—É—Ä—Å–∞</th>
            </tr>
        </thead>
        <tbody>
            <!-- –°—Ç—Ä–æ–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å—é–¥–∞ -->
        </tbody>
    </table>

    <!-- –ë–ª–æ–∫ —Å –ø–æ–¥–ø–∏—Å—å—é –≤—Ä–∞—á–∞ -->
    <div class="doctor-signature">
        <p><strong>–ó–∞–≤–µ–¥—É—é—â–∏–π –æ—Ç–¥–µ–ª–µ–Ω–∏–µ–º:</strong> –ö–æ–≤–∞–ª—å—á—É–∫ –¢.–°.</p>
        <p style="float: right;">–ü–æ–¥–ø–∏—Å—å _______________</p>
    </div>

    <!-- –ö–Ω–æ–ø–∫–∞ –ø–µ—á–∞—Ç–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) -->
    <div class="print-button" onclick="window.print()">
        <span class="print-icon">üñ®Ô∏è</span> –ü–µ—á–∞—Ç—å
    </div>

    <script>
    // –£–∫–∞–∑—ã–≤–∞–µ–º, –∫–∞–∫–∏–µ –∫–æ–ª–æ–Ω–∫–∏ –Ω—É–∂–Ω—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤–∏–¥–∂–µ—Ç–∞
    grist.ready({
      requiredAccess: 'read table',
      columns: [
        'patient_FIO', 'patient_age', 'diagnoz', 'date_mdb', 'reabilitacionnyi_diagnoz', 'FIO_user',
        'FIO_user', 'uchastie', 'target', 'Domen_C', 'zadachi', 'metodika',
        'ocenka_do_kursa', 'ocenka_posle'
      ]
    });

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∑–∞–ø–∏—Å–∏
    grist.onRecord(function(record) {
      console.log("–í—ã–±—Ä–∞–Ω–Ω–∞—è –∑–∞–ø–∏—Å—å:", record); // –û—Ç–ª–∞–¥–∫–∞

      // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–∞—Ü–∏–µ–Ω—Ç–µ
      document.getElementById('patient_FIO').textContent = record.patient_FIO || '';
      document.getElementById('patient_age').textContent = record.patient_age || '';
      document.getElementById('diagnoz').textContent = record.diagnoz || '';
      document.getElementById('date_mdb').textContent = record.date_mdb || '';
      document.getElementById('mkf_values').textContent = record.reabilitacionnyi_diagnoz || '';

      // –§–∏–ª—å—Ç—Ä—É–µ–º –∑–∞–ø–∏—Å–∏ –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É patient_FIO
      filterRecordsByFio(record.patient_FIO);
    });

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∑–∞–ø–∏—Å–µ–π –ø–æ patient_FIO
    async function filterRecordsByFio(patient_FIO) {
      try {
        // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã
        const tableData = await grist.fetchSelectedTable();
        console.log("–î–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:", tableData); // –û—Ç–ª–∞–¥–∫–∞

        // –û—á–∏—â–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        const tableBody = document.querySelector('#doctorsTable tbody');
        tableBody.innerHTML = '';

        // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º
        const groupedData = groupDataByParticipant(tableData, patient_FIO);

        // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ú–ö–§
        const mkfValues = new Set();

        // –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –≤ —Ç–∞–±–ª–∏—Ü—É
        let rowNumber = 1;
        groupedData.forEach(participant => {
          // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä–æ–∫—É —Å —É—á–∞—Å—Ç–Ω–∏–∫–æ–º
          const participantRow = tableBody.insertRow();
          participantRow.classList.add('participant-row');
          participantRow.insertCell().textContent = rowNumber++;
          participantRow.insertCell().textContent = participant.name || '';
          participantRow.insertCell().textContent = participant.uchastie || '';
          participantRow.insertCell().textContent = ''; // –¶–µ–ª—å (–ø—É—Å—Ç–æ, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–∞)
          participantRow.insertCell().textContent = ''; // –ú–ö–§ (–ø—É—Å—Ç–æ, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–∞)
          participantRow.insertCell().textContent = ''; // –ó–∞–¥–∞—á–∏ (–ø—É—Å—Ç–æ, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–∞)
          participantRow.insertCell().textContent = ''; // –ú–µ—Ç–æ–¥–∏–∫–∞ (–ø—É—Å—Ç–æ, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–∞)
          participantRow.insertCell().textContent = ''; // –û—Ü–µ–Ω–∫–∞ –¥–æ –∫—É—Ä—Å–∞ (–ø—É—Å—Ç–æ, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–∞)
          participantRow.insertCell().textContent = ''; // –û—Ü–µ–Ω–∫–∞ –ø–æ—Å–ª–µ –∫—É—Ä—Å–∞ (–ø—É—Å—Ç–æ, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–∞)

          // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä–æ–∫–∏ —Å —Ü–µ–ª—è–º–∏, –∑–∞–¥–∞—á–∞–º–∏ –∏ –º–µ—Ç–æ–¥–∏–∫–∞–º–∏
          participant.goals.forEach(goal => {
            const goalRow = tableBody.insertRow();
            goalRow.classList.add('goal-row');
            goalRow.insertCell().textContent = ''; // ‚Ññ (–ø—É—Å—Ç–æ, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–∞)
            goalRow.insertCell().textContent = ''; // –£—á–∞—Å—Ç–Ω–∏–∫ (–ø—É—Å—Ç–æ, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–∞)
            goalRow.insertCell().textContent = ''; // –£—á–∞—Å—Ç–∏–µ (–ø—É—Å—Ç–æ, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–∞)
            goalRow.insertCell().textContent = goal.target || ''; // –¶–µ–ª—å
            goalRow.insertCell().textContent = ''; // –ú–ö–§ (–ø—É—Å—Ç–æ, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–∞)
            goalRow.insertCell().textContent = ''; // –ó–∞–¥–∞—á–∏ (–ø—É—Å—Ç–æ, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–∞)
            goalRow.insertCell().textContent = ''; // –ú–µ—Ç–æ–¥–∏–∫–∞ (–ø—É—Å—Ç–æ, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–∞)
            goalRow.insertCell().textContent = ''; // –û—Ü–µ–Ω–∫–∞ –¥–æ –∫—É—Ä—Å–∞ (–ø—É—Å—Ç–æ, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–∞)
            goalRow.insertCell().textContent = ''; // –û—Ü–µ–Ω–∫–∞ –ø–æ—Å–ª–µ –∫—É—Ä—Å–∞ (–ø—É—Å—Ç–æ, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–∞)

            goal.tasks.forEach(task => {
              const taskRow = tableBody.insertRow();
              taskRow.classList.add('task-row');
              taskRow.insertCell().textContent = ''; // ‚Ññ (–ø—É—Å—Ç–æ, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–∞)
              taskRow.insertCell().textContent = ''; // –£—á–∞—Å—Ç–Ω–∏–∫ (–ø—É—Å—Ç–æ, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–∞)
              taskRow.insertCell().textContent = ''; // –£—á–∞—Å—Ç–∏–µ (–ø—É—Å—Ç–æ, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–∞)
              taskRow.insertCell().textContent = ''; // –¶–µ–ª—å (–ø—É—Å—Ç–æ, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–∞)
              taskRow.insertCell().textContent = task.Domen_C || ''; // –ú–ö–§
              taskRow.insertCell().textContent = task.zadachi || ''; // –ó–∞–¥–∞—á–∏
              taskRow.insertCell().textContent = task.metodika || ''; // –ú–µ—Ç–æ–¥–∏–∫–∞
              taskRow.insertCell().textContent = task.ocenka_do_kursa || ''; // –û—Ü–µ–Ω–∫–∞ –¥–æ –∫—É—Ä—Å–∞
              taskRow.insertCell().textContent = task.ocenka_posle || ''; // –û—Ü–µ–Ω–∫–∞ –ø–æ—Å–ª–µ –∫—É—Ä—Å–∞

              // –î–æ–±–∞–≤–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –ú–ö–§ –≤ Set
              if (task.Domen_C) {
                mkfValues.add(task.Domen_C);
              }
            });
          });
        });

        // –û–±–Ω–æ–≤–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç —Å –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ–º –≤—Å–µ—Ö –∑–Ω–∞—á–µ–Ω–∏–π –ú–ö–§
        document.getElementById('mkf_values').textContent = Array.from(mkfValues).join(', ');
      } catch (error) {
        console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∑–∞–ø–∏—Å–µ–π:", error); // –û—Ç–ª–∞–¥–∫–∞
      }
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º
    function groupDataByParticipant(tableData, patient_FIO) {
      const groupedData = [];
      const rowCount = tableData.patient_FIO.length;

      for (let i = 0; i < rowCount; i++) {
        if (tableData.patient_FIO[i] === patient_FIO) {
          const participantName = tableData.FIO_user[i];
          const target = tableData.target[i];
          const zadachi = tableData.zadachi[i];
          const metodika = tableData.metodika[i];
          const Domen_C = tableData.Domen_C[i];
          const ocenka_do_kursa = tableData.ocenka_do_kursa[i];
          const ocenka_posle = tableData.ocenka_posle[i];

          // –ò—â–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–∞ –≤ groupedData
          let participant = groupedData.find(p => p.name === participantName);
          if (!participant) {
            participant = {
              name: participantName,
              uchastie: tableData.uchastie[i],
              goals: []
            };
            groupedData.push(participant);
          }

          // –ò—â–µ–º —Ü–µ–ª—å –≤ goals —É—á–∞—Å—Ç–Ω–∏–∫–∞
          let goal = participant.goals.find(g => g.target === target);
          if (!goal) {
            goal = {
              target: target,
              tasks: []
            };
            participant.goals.push(goal);
          }

          // –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–¥–∞—á—É –≤ —Ü–µ–ª—å
          goal.tasks.push({
            Domen_C: Domen_C,
            zadachi: zadachi,
            metodika: metodika,
            ocenka_do_kursa: ocenka_do_kursa,
            ocenka_posle: ocenka_posle
          });
        }
      }

      return groupedData;
    }
    </script>
</body>
</html>
